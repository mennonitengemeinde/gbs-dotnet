@page "/school/{Id:int}/live"
@attribute [Authorize]
@using gbs.Client.Pages.School.Components
@inject IStreamService StreamService
@inject NavigationManager NavigationManager

@if (LiveStream != null)
{
    <LiveVideoPlayer LiveStream="@LiveStream"/>
}

@code {
    [Parameter]
    public int Id { get; set; }
    
    [Parameter]
    public StreamGetDto? LiveStream { get; set; }

    protected override async Task OnInitializedAsync()
    {

        var liveStream = await StreamService.GetStreamById(Id, true);
        if (!liveStream.Success)
        {
            NavigationManager.NavigateTo("school");
        }
        else
        {
            LiveStream = liveStream.Data;
        }
    }
}